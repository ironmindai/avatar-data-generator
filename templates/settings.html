{% extends "base.html" %}
{% set show_header = true %}
{% set show_sidebar = true %}
{% set active_page = 'settings' %}

{% block meta_description %}Settings - Avatar Data Generator by Galacticos AI{% endblock %}

{% block title %}Settings - Avatar Data Generator by Galacticos AI{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/settings.css">
{% endblock %}

{% block content %}
<div class="content-wrapper">
    <!-- Page Header -->
    <div class="page-header">
        <h1 class="page-title">SETTINGS</h1>
        <p class="page-description">
            Configure bio generation prompts and application preferences
        </p>
    </div>

    <!-- Settings Container -->
    <div class="settings-container">
        <!-- Face Generation Settings Section -->
        <div class="settings-section">
            <div class="section-header">
                <i data-feather="user" class="section-icon"></i>
                <h2 class="section-title">FACE GENERATION SETTINGS</h2>
            </div>
            <p class="section-description">
                Configure face randomization options for base image generation. These experimental features control how avatar faces are generated.
            </p>

            <!-- Form Wrapper for Elevated Background -->
            <div class="settings-form-wrapper">
                <form id="faceSettingsForm" class="settings-form">
                    <!-- Crop White Borders Checkbox -->
                    <div class="form-group">
                        <label class="checkbox-container">
                            <input
                                type="checkbox"
                                id="crop_white_borders"
                                name="crop_white_borders"
                                class="checkbox-input"
                                {% if crop_white_borders %}checked{% endif %}
                            >
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-label">
                                CROP WHITE BORDERS
                            </span>
                        </label>
                        <p class="form-help checkbox-help">
                            Automatically remove white borders from generated images
                        </p>
                    </div>

                    <!-- Main Checkbox: Randomize Face -->
                    <div class="form-group">
                        <label class="checkbox-container">
                            <input
                                type="checkbox"
                                id="randomize_face_base"
                                name="randomize_face_base"
                                class="checkbox-input"
                                {% if randomize_face_base %}checked{% endif %}
                            >
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-label">
                                RANDOMIZE FACE FOR BASE GENERATION (EXPERIMENTAL)
                            </span>
                        </label>
                        <p class="form-help checkbox-help">
                            Enable random face generation for avatar base images instead of using predefined faces
                        </p>
                    </div>

                    <!-- Sub-Checkbox: Gender Lock (Nested) -->
                    <div class="form-group form-group-nested" id="genderLockGroup" style="display: none;">
                        <label class="checkbox-container">
                            <input
                                type="checkbox"
                                id="randomize_face_gender_lock"
                                name="randomize_face_gender_lock"
                                class="checkbox-input"
                                {% if randomize_face_gender_lock %}checked{% endif %}
                            >
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-label">
                                GENDER LOCK
                            </span>
                        </label>
                        <p class="form-help checkbox-help">
                            Lock the generated face to a specific gender during randomization
                        </p>
                    </div>

                    <!-- Form Actions -->
                    <div class="form-actions">
                        <button type="submit" id="saveFaceSettingsButton" class="btn btn-primary" disabled>
                            <i data-feather="save"></i>
                            <span class="btn-text">SAVE CHANGES</span>
                            <span class="btn-loading" style="display: none;">
                                <span class="spinner-small"></span>
                                SAVING...
                            </span>
                        </button>
                        <button type="button" id="resetFaceSettingsButton" class="btn btn-secondary">
                            <i data-feather="rotate-ccw"></i>
                            RESET TO ORIGINAL
                        </button>
                    </div>
                </form>
            </div>
            <!-- End Form Wrapper -->
        </div>

        <!-- Bio Prompts Configuration Section -->
        <div class="settings-section">
            <div class="section-header">
                <i data-feather="file-text" class="section-icon"></i>
                <h2 class="section-title">BIO PROMPTS CONFIGURATION</h2>
            </div>
            <p class="section-description">
                Customize the AI prompts used to generate biographical content for each social media platform. These prompts guide the AI in creating platform-appropriate bios.
            </p>

            <!-- Form Wrapper for Elevated Background -->
            <div class="settings-form-wrapper">
                <form id="settingsForm" method="POST" action="/settings/save" class="settings-form">
                <!-- CSRF Token -->
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>

                <!-- Facebook Bio Prompt -->
                <div class="form-group">
                    <label for="facebook_bio_prompt" class="form-label">
                        <i data-feather="facebook" class="form-label-icon"></i>
                        FACEBOOK BIO PROMPT
                    </label>
                    <p class="form-help" id="facebook-help">
                        Prompt template for generating Facebook-style biographical content
                    </p>
                    <div class="textarea-wrapper">
                        <textarea
                            id="bio_prompt_facebook"
                            name="bio_prompt_facebook"
                            class="form-input form-textarea"
                            rows="5"
                            placeholder="Enter the prompt for Facebook bio generation..."
                            aria-label="Facebook Bio Prompt"
                            aria-describedby="facebook-help"
                            required
                        >{{ bio_prompts.bio_prompt_facebook or '' }}</textarea>
                        <span class="char-count" data-target="bio_prompt_facebook">0 characters</span>
                    </div>
                </div>

                <!-- Instagram Bio Prompt -->
                <div class="form-group">
                    <label for="instagram_bio_prompt" class="form-label">
                        <i data-feather="instagram" class="form-label-icon"></i>
                        INSTAGRAM BIO PROMPT
                    </label>
                    <p class="form-help" id="instagram-help">
                        Prompt template for generating Instagram-style biographical content
                    </p>
                    <div class="textarea-wrapper">
                        <textarea
                            id="bio_prompt_instagram"
                            name="bio_prompt_instagram"
                            class="form-input form-textarea"
                            rows="5"
                            placeholder="Enter the prompt for Instagram bio generation..."
                            aria-label="Instagram Bio Prompt"
                            aria-describedby="instagram-help"
                            required
                        >{{ bio_prompts.bio_prompt_instagram or '' }}</textarea>
                        <span class="char-count" data-target="bio_prompt_instagram">0 characters</span>
                    </div>
                </div>

                <!-- X (Twitter) Bio Prompt -->
                <div class="form-group">
                    <label for="x_bio_prompt" class="form-label">
                        <i data-feather="twitter" class="form-label-icon"></i>
                        X (TWITTER) BIO PROMPT
                    </label>
                    <p class="form-help" id="x-help">
                        Prompt template for generating X (Twitter)-style biographical content
                    </p>
                    <div class="textarea-wrapper">
                        <textarea
                            id="bio_prompt_x"
                            name="bio_prompt_x"
                            class="form-input form-textarea"
                            rows="5"
                            placeholder="Enter the prompt for X (Twitter) bio generation..."
                            aria-label="X (Twitter) Bio Prompt"
                            aria-describedby="x-help"
                            required
                        >{{ bio_prompts.bio_prompt_x or '' }}</textarea>
                        <span class="char-count" data-target="bio_prompt_x">0 characters</span>
                    </div>
                </div>

                <!-- TikTok Bio Prompt -->
                <div class="form-group">
                    <label for="tiktok_bio_prompt" class="form-label">
                        <svg class="form-label-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-5.2 1.74 2.89 2.89 0 012.31-4.64 2.93 2.93 0 01.88.13V9.4a6.84 6.84 0 00-1-.05A6.33 6.33 0 005 20.1a6.34 6.34 0 0010.86-4.43v-7a8.16 8.16 0 004.77 1.52v-3.4a4.85 4.85 0 01-1-.1z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        TIKTOK BIO PROMPT
                    </label>
                    <p class="form-help" id="tiktok-help">
                        Prompt template for generating TikTok-style biographical content
                    </p>
                    <div class="textarea-wrapper">
                        <textarea
                            id="bio_prompt_tiktok"
                            name="bio_prompt_tiktok"
                            class="form-input form-textarea"
                            rows="5"
                            placeholder="Enter the prompt for TikTok bio generation..."
                            aria-label="TikTok Bio Prompt"
                            aria-describedby="tiktok-help"
                            required
                        >{{ bio_prompts.bio_prompt_tiktok or '' }}</textarea>
                        <span class="char-count" data-target="bio_prompt_tiktok">0 characters</span>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="submit" id="saveButton" class="btn btn-primary" disabled>
                        <i data-feather="save"></i>
                        <span class="btn-text">SAVE CHANGES</span>
                        <span class="btn-loading" style="display: none;">
                            <span class="spinner-small"></span>
                            SAVING...
                        </span>
                    </button>
                    <button type="button" id="resetButton" class="btn btn-secondary">
                        <i data-feather="rotate-ccw"></i>
                        RESET TO ORIGINAL
                    </button>
                </div>
            </form>
            </div>
            <!-- End Form Wrapper -->
        </div>

        <!-- Information Card -->
        <div class="info-card">
            <i data-feather="info" class="info-card-icon"></i>
            <h3 class="info-card-title">ABOUT BIO PROMPTS</h3>
            <p class="info-card-text">
                Bio prompts are AI instructions that define how biographical content should be generated for each platform. They help ensure the generated bios match the tone, style, and character limits of each social media platform.
            </p>
            <ul class="info-card-list">
                <li><strong>Facebook:</strong> Longer, detailed personal stories</li>
                <li><strong>Instagram:</strong> Concise, emoji-friendly, hashtag-aware</li>
                <li><strong>X (Twitter):</strong> Brief, witty, 160-character limit</li>
                <li><strong>TikTok:</strong> Fun, trendy, creative with emojis</li>
            </ul>
        </div>
    </div>
</div>

<!-- Notification Toast (hidden by default) -->
<div id="toast" class="toast" style="display: none;" role="alert" aria-live="polite">
    <i data-feather="check-circle" id="toastIcon"></i>
    <span id="toastMessage">Settings saved successfully</span>
</div>
{% endblock %}

{% block extra_js %}
<!-- Settings page specific JavaScript -->
<script src="/static/js/settings.js"></script>
{% endblock %}
